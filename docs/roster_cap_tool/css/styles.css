:root {
  --green: #15803d;
  --red: #b91c1c;
  --yellow: #ca8a04;
  --blue: #1d4ed8;
  --bg: #0b1220;
  --panel: #0f172a;
  --muted: #94a3b8;
  --text: #e2e8f0;
  --accent: #22c55e;
}

* { box-sizing: border-box; }
html, body { height: 100%; }
body {
  margin: 0;
  font-family: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
  background: var(--bg);
  color: var(--text);
}

/* Accessible focus ring */
:focus-visible { outline: 2px solid var(--blue); outline-offset: 2px; }
.sr-only { position: absolute; width: 1px; height: 1px; padding: 0; margin: -1px; overflow: hidden; clip: rect(0,0,0,0); white-space: nowrap; border: 0; }

.header {
  position: sticky;
  top: 0;
  z-index: 50;
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 1rem;
  padding: .75rem 1rem;
  background: rgba(15, 23, 42, 0.9);
  backdrop-filter: blur(6px);
  border-bottom: 1px solid #1f2937;
}
.app-title { font-size: 1.125rem; margin: 0; }
.header__right { display: flex; align-items: center; gap: 1rem; }
.scenario-controls { display:flex; gap:.5rem; align-items:center; }

/* Bottom strip inside header for projections */
.projections-top { background: var(--panel); border: 1px solid #1f2937; border-radius: .5rem; padding: .5rem .75rem; margin-bottom: .75rem; }
.projections-top .proj-strip { display: flex; align-items: center; gap: .5rem; flex-wrap: wrap; }
.projections-top .label { color: var(--muted); font-size: .8rem; margin-right: .25rem; }
.input-number { background: #0b1324; color: var(--text); border: 1px solid #334155; padding: .25rem .5rem; border-radius: .375rem; width: 9ch; min-width: 130px; }

.container { padding: 1rem; max-width: 1300px; margin: 0 auto; }

.team-selector select { background: #0b1324; color: var(--text); border: 1px solid #334155; padding: .5rem; border-radius: .375rem; }

.cap-summary { display: grid; grid-auto-flow: column; gap: 1rem; align-items: center; }
.cap-summary .metric { display: grid; gap: .125rem; }
.cap-summary .metric .label { color: var(--muted); font-size: .75rem; }
.cap-summary .metric .value { font-weight: 600; }
.progress { height: 8px; background: #1f2937; border-radius: 8px; overflow: hidden; width: 220px; }
.progress .bar { height: 100%; background: var(--accent); width: 0%; transition: width .25s ease-in-out; }

.tabs { display: flex; gap: .5rem; padding: .5rem; border-bottom: 1px solid #1f2937; position: sticky; top: 58px; background: var(--bg); z-index: 40; }
.tab { background: #0b1324; color: var(--text); border: 1px solid #334155; padding: .5rem .75rem; border-radius: .375rem; cursor: pointer; }
.tab.is-active { border-color: var(--blue); color: #cfe3ff; }

.panels { padding-top: 1rem; }
.panel { display: none; }
.panel.is-active { display: block; }

.table-container { background: var(--panel); border: 1px solid #1f2937; border-radius: .5rem; overflow: auto; }
table { width: 100%; border-collapse: collapse; font-size: .925rem; }
th, td { padding: .625rem .75rem; border-bottom: 1px solid #1f2937; white-space: nowrap; }
/* Make table headers sticky within the scrolling table container */
th { position: sticky; top: 0; background: var(--panel); text-align: left; color: var(--muted); font-weight: 500; z-index: 2; }
tr:hover td { background: rgba(148,163,184,0.06); }

.badge { display: inline-block; padding: .125rem .375rem; border-radius: .25rem; font-size: .75rem; border: 1px solid #334155; color: #cbd5e1; }
.pos-QB { border-color: #f59e0b; color: #f59e0b; }
.pos-WR { border-color: #22c55e; color: #22c55e; }
.pos-RB, .pos-HB { border-color: #06b6d4; color: #06b6d4; }
.pos-FB { border-color: #14b8a6; color: #14b8a6; }
.pos-TE { border-color: #a855f7; color: #a855f7; }
/* Offensive line */
.pos-LT, .pos-LG, .pos-C, .pos-RG, .pos-RT, .pos-OL { border-color: #60a5fa; color: #60a5fa; }
/* Defensive line / edge */
.pos-LE, .pos-RE, .pos-DE, .pos-DT, .pos-DL, .pos-EDGE, .pos-LEDGE, .pos-REDGE { border-color: #f97316; color: #f97316; }
/* Linebackers */
.pos-LB, .pos-OLB, .pos-ILB, .pos-LOLB, .pos-MLB, .pos-ROLB, .pos-MIKE, .pos-SAM, .pos-WILL { border-color: #818cf8; color: #818cf8; }
/* Secondary */
.pos-CB { border-color: #22d3ee; color: #22d3ee; }
.pos-FS, .pos-SS, .pos-S, .pos-DB { border-color: #38bdf8; color: #38bdf8; }
/* Specialists */
.pos-K { border-color: #84cc16; color: #84cc16; }
.pos-P { border-color: #65a30d; color: #65a30d; }
.pos-LS { border-color: #94a3b8; color: #94a3b8; }

/* Filters bar for position chips */
.filters-bar { display: flex; flex-wrap: wrap; gap: .5rem; padding: .5rem; border-bottom: 1px solid #1f2937; align-items: center; }
.filters-bar .filters-label { color: var(--muted); font-size: .8rem; margin-right: .25rem; }
.chip { display: inline-flex; align-items: center; gap: .25rem; padding: .25rem .5rem; border-radius: 9999px; border: 1px solid #334155; background: #0b1324; color: var(--text); cursor: pointer; font-size: .8rem; }
.chip:hover { background: #0f172a; }
.chip.is-active { border-color: var(--blue); color: #dbeafe; }
.chip .swatch { width: .5rem; height: .5rem; border-radius: 9999px; display: inline-block; }

.money-pos { color: var(--green); font-weight: 600; }
.money-neg { color: var(--red); font-weight: 600; }
.money-warn { color: var(--yellow); font-weight: 600; }

dialog { border: 1px solid #334155; background: var(--panel); color: var(--text); border-radius: .5rem; padding: 1rem; max-width: 640px; width: min(92vw, 640px); }
dialog::backdrop { background: rgba(2, 6, 23, 0.6); }
.modal-actions { display: flex; justify-content: flex-end; gap: .5rem; margin-top: 1rem; }
.btn { border: 1px solid #334155; background: #0b1324; color: var(--text); padding: .5rem .75rem; border-radius: .375rem; cursor: pointer; }
.btn.primary { border-color: var(--blue); color: #dbeafe; }
.btn.danger { border-color: var(--red); color: #fecaca; }
.btn:disabled { opacity: .5; cursor: not-allowed; }

/* Drawer â€” right-side modal using <dialog> */
.drawer {
  /* Make the dialog behave like a right-side drawer */
  position: fixed;
  inset: 0 0 0 auto; /* top right bottom, left auto */
  margin: 0;
  width: min(95vw, 720px);
  max-width: 720px;
  height: 100dvh;
  border-radius: 0;
  border-right: none;
  border-left: 1px solid #334155;
  padding: 1rem 1rem 1rem 1rem;
  display: grid;
  grid-template-rows: auto 1fr auto; /* header, content, footer */
  gap: .75rem;
  /* Slide-in animation */
  transform: translateX(100%);
  transition: transform .22s ease-out;
}
/* Support both explicit class toggle and native [open] attr */
.drawer--open,
dialog.drawer[open] {
  transform: translateX(0%);
}
dialog.drawer::backdrop { background: rgba(2, 6, 23, 0.6); }

/* Contract Editor specific layout */
.drawer [data-dialog-title] { font-size: 1.05rem; margin: 0; }

/* Drawer header bar */
.drawer__header { display:flex; align-items:center; justify-content:space-between; gap:.75rem; position: sticky; top: 0; background: var(--panel); padding-bottom: .5rem; border-bottom: 1px solid #1f2937; z-index: 5; }
.drawer__titlewrap { display:grid; gap:.25rem; }
.drawer__subtitle { color: var(--muted); font-size: .875rem; margin: .125rem 0 0; }
.drawer__actions { display:flex; gap:.5rem; align-items:center; }

/* Generic field helpers */
.field { display:grid; gap:.25rem; }
.field__label { color: var(--muted); font-size: .85em; }
.muted { color: var(--muted); }

/* Grid with a column per year */
.ce-grid {
  display: grid;
  grid-auto-flow: column;
  gap: .75rem;
  overflow: auto;
  scroll-snap-type: x mandatory;
  padding-bottom: .25rem;
}
/* Each year column */
.ce-col {
  display: grid;
  gap: .5rem;
  min-width: 200px;
  background: #0b1324;
  border: 1px solid #334155;
  border-radius: .5rem;
  padding: .75rem;
  scroll-snap-align: start;
  box-shadow: 0 1px 0 rgba(0,0,0,0.2);
}

/* Year header cell */
[data-testid="ce-year"] { text-align: center; font-weight: 600; font-size: .95rem; padding: .25rem .5rem; border: 1px solid #334155; border-radius: .375rem; display: inline-block; margin: 0 auto .25rem; color: #cbd5e1; }

/* Inputs inside the drawer */
.drawer input[type="number"],
.drawer input[type="text"],
.drawer input[type="search"] {
  background: #0b1324;
  color: var(--text);
  border: 1px solid #334155;
  border-radius: .375rem;
  padding: .5rem .625rem;
  width: 100%;
  transition: border-color .12s ease-in-out, box-shadow .12s ease-in-out;
}
.drawer input[type="number"]::-webkit-outer-spin-button,
.drawer input[type="number"]::-webkit-inner-spin-button { -webkit-appearance: none; margin: 0; }
.drawer input[type="number"] { -moz-appearance: textfield; }
.drawer input:focus { border-color: var(--blue); box-shadow: 0 0 0 3px rgba(29,78,216,0.25); outline: none; }

/* Small muted preview lines under inputs */
[data-testid="ce-prev-salary"],
[data-testid="ce-prev-bonus"] {
  color: var(--muted);
  font-size: .8em;
  text-align: right;
}

/* Adornment: show "M" suffix for the millions unit.
   Uses :has() to target labels that contain contract inputs. */
.drawer label:has(> [data-testid="ce-input-salary"]),
.drawer label:has(> [data-testid="ce-input-bonus"]) {
  position: relative;
}
.drawer label:has(> [data-testid="ce-input-salary"])::after,
.drawer label:has(> [data-testid="ce-input-bonus"])::after {
  content: "M";
  position: absolute;
  right: .5rem;
  /* place roughly centered on the input line */
  top: 2.35rem;
  color: var(--muted);
  pointer-events: none;
}
/* Ensure input has space for the suffix */
.drawer [data-testid="ce-input-salary"],
.drawer [data-testid="ce-input-bonus"] {
  padding-right: 1.4rem !important;
}

/* Scrollbar cosmetics in the horizontal grid */
.ce-grid { scrollbar-color: #334155 transparent; scrollbar-width: thin; }
.ce-grid::-webkit-scrollbar { height: 10px; }
.ce-grid::-webkit-scrollbar-track { background: transparent; }
.ce-grid::-webkit-scrollbar-thumb { background: #334155; border-radius: 8px; }

/* Responsive drawer width and grid flow */
@media (max-width: 640px) {
  .drawer { width: 100vw; max-width: 100vw; }
  .ce-grid { grid-auto-flow: row; }
  .ce-col { min-width: unset; }
}

/* Reduce motion preference */
@media (prefers-reduced-motion: reduce) {
  .progress .bar { transition: none; }
}

@media (max-width: 900px) {
  .cap-summary { grid-auto-flow: row; gap: .5rem; }
  .scenario-controls { display:flex; gap:.25rem; }
  .projections-top .proj-strip { gap: .25rem; }
  /* Headers remain sticky at the top of their container */
  th { top: 0; }
}

/* Tablet adjustments */
@media (max-width: 1024px) {
  /* Allow tabs to wrap */
  .tabs { flex-wrap: wrap; row-gap: .5rem; }
}

/* Mobile: convert table rows into cards */
@media (max-width: 700px) {
  .header { flex-wrap: wrap; align-items: flex-start; gap: .5rem; }
  .header__right { flex-wrap: wrap; }

  .table-container { overflow: visible; }
  table, thead, tbody, th, td, tr { display: block; }
  thead { display: none; }
  tr { border-bottom: 1px solid #1f2937; margin-bottom: .5rem; background: transparent; }
  td { display: grid; grid-template-columns: minmax(8rem, 40%) 1fr; gap: .25rem .5rem; align-items: start; white-space: normal; }
  td::before { content: attr(data-label); color: var(--muted); font-size: .8rem; }
  /* Player cell spans full width */
  td.cell-player { grid-template-columns: 1fr; }
  td.cell-player::before { content: none; }
  /* Action cell aligns right */
  td.cell-action { justify-content: end; }
}
