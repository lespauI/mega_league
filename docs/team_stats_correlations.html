<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Team Statistics — Interesting Correlations</title>
  <script src="https://cdn.jsdelivr.net/npm/d3@7"></script>
  <style>
    :root {
      --red: #ef4444;
      --blue: #0ea5e9;
      --grid: #e8eaed;
      --axis: #9aa0a6;
      --text: #222;
    }
    body { margin: 16px; font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; color: var(--text); background: #f7f7f7; }
    .container { max-width: 1200px; margin: 0 auto; background: #fff; border: 1px solid #e5e5e5; border-radius: 10px; padding: 12px 16px 22px; box-shadow: 0 1px 3px rgba(0,0,0,.06); }
    h1 { margin: 0 0 10px; font-size: 22px; }
    .subtitle { color: #666; font-size: 13px; margin: 4px 0 12px; }
    .controls { display: flex; align-items: center; gap: 10px; margin: 6px 0 8px; }
    .panel { margin: 12px 0 14px; border: 1px solid #e5e5e5; border-radius: 10px; overflow: hidden; background: #fff; }
    .panel > summary { padding: 10px 14px; background: #f5f7fa; border-bottom: 1px solid #ebeff5; font-weight: 600; cursor: pointer; user-select: none; list-style: none; }
    .panel[open] > summary { border-bottom-color: #e6eaf0; }
    .chart-wrap { padding: 8px 8px 0; }
    .legend { display: flex; align-items: center; gap: 16px; color: #555; font-size: 12px; padding: 0 10px 10px; }
    .swatch { display: inline-block; width: 12px; height: 12px; border-radius: 2px; margin-right: 6px; vertical-align: middle; }
    .avg { background: repeating-linear-gradient(90deg, #bbb, #bbb 2px, transparent 2px, transparent 6px); border: 1px solid #bbb; }
    .red { background: var(--red); opacity: .5; }
    .blue { background: var(--blue); opacity: .5; }
    .tooltip { position: absolute; pointer-events: none; background: rgba(0,0,0,.78); color: #fff; padding: 6px 8px; border-radius: 6px; font-size: 12px; z-index: 10; }
    .info { background: #f3f6fa; border: 1px solid #e1e7ef; border-radius: 8px; padding: 10px 14px; color: #243246; font-size: 14px; margin: 8px 0 12px; }
    .info summary { font-weight: 600; cursor: pointer; }
    .correlation-badge { display: inline-block; padding: 2px 8px; border-radius: 4px; font-size: 11px; font-weight: 600; }
    .corr-strong { background: #dcfce7; color: #166534; }
    .corr-moderate { background: #fef3c7; color: #854d0e; }
    .corr-weak { background: #fee2e2; color: #991b1b; }
    .help-icon { display: inline-block; width: 16px; height: 16px; border-radius: 50%; background: #3b82f6; color: white; text-align: center; line-height: 16px; font-size: 11px; font-weight: bold; margin-left: 8px; cursor: help; vertical-align: middle; }
    .metric-tooltip { position: absolute; pointer-events: none; background: rgba(30,64,175,.95); color: #fff; padding: 8px 12px; border-radius: 6px; font-size: 12px; z-index: 100; max-width: 350px; line-height: 1.5; box-shadow: 0 4px 6px rgba(0,0,0,.3); }
  </style>
  <script>
    async function tryCsv(paths) {
      let lastErr;
      for (const p of paths) {
        try { return await d3.csv(p, d3.autoType); } catch (e) { lastErr = e; }
      }
      throw lastErr || new Error('Unable to load CSV: ' + paths.join(', '));
    }

    function fmt2(x) { return d3.format('.2f')(x); }
    function fmt3(x) { return d3.format('.3f')(x); }
    function toPct(x) { return d3.format('.1%')(x); }

    function regression(points) {
      let n = 0, sx = 0, sy = 0, sxy = 0, sxx = 0, syy = 0;
      for (const [x0, y0] of points) {
        const x = +x0, y = +y0;
        if (!Number.isFinite(x) || !Number.isFinite(y)) continue;
        n++; sx += x; sy += y; sxy += x*y; sxx += x*x; syy += y*y;
      }
      if (n < 2) return { m: 0, b: sy / (n || 1), r2: 0 };
      const denom = n * sxx - sx * sx;
      const m = denom !== 0 ? (n * sxy - sx * sy) / denom : 0;
      const b = (sy - m * sx) / n;
      
      const ssr = points.reduce((sum, [x0, y0]) => {
        const x = +x0, y = +y0;
        if (!Number.isFinite(x) || !Number.isFinite(y)) return sum;
        return sum + Math.pow(y - (m * x + b), 2);
      }, 0);
      const sst = syy - (sy * sy) / n;
      const r2 = sst !== 0 ? Math.max(0, 1 - ssr / sst) : 0;
      
      return { m, b, r2 };
    }

    async function loadData() {
      const stats = await tryCsv([
        '../output/team_aggregated_stats.csv',
        'output/team_aggregated_stats.csv',
        '/output/team_aggregated_stats.csv'
      ]);

      for (const row of stats) {
        row.logoUrl = (row.logoId !== '' && row.logoId != null) ? 
          `https://cdn.neonsportz.com/teamlogos/256/${row.logoId}.png` : null;
      }

      return stats;
    }

    function drawScatter(holder, rows, cfg) {
      const data = rows.filter(d => 
        Number.isFinite(+d[cfg.xKey]) && Number.isFinite(+d[cfg.yKey])
      );

      if (data.length < 2) return;

      const margin = { top: 20, right: 24, bottom: 46, left: 70 };
      const width = 1080, height = 480;
      const innerW = width - margin.left - margin.right;
      const innerH = height - margin.top - margin.bottom;

      const panel = holder.append('details').attr('class', 'panel').attr('open', true);
      const summary = panel.append('summary');
      summary.append('span').text(cfg.title);
      
      if (cfg.metricHelp) {
        const helpIcon = summary.append('span').attr('class', 'help-icon').text('?');
        const metricTip = d3.select('body').append('div').attr('class', 'metric-tooltip').style('display', 'none');
        helpIcon.on('mouseenter', function(evt) {
          metricTip.style('display', 'block').html(cfg.metricHelp);
        }).on('mousemove', (evt) => {
          metricTip.style('left', (evt.pageX + 12) + 'px').style('top', (evt.pageY - 28) + 'px');
        }).on('mouseleave', () => {
          metricTip.style('display', 'none');
        });
      }
      
      const wrap = panel.append('div').attr('class', 'chart-wrap');
      const svg = wrap.append('svg').attr('width', width).attr('height', height);
      const g = svg.append('g').attr('transform', `translate(${margin.left},${margin.top})`);

      const yVals = data.map(d => +d[cfg.yKey]);
      const yMin = d3.min(yVals), yMax = d3.max(yVals);
      const yRange = yMax - yMin;
      const yPad = yRange * 0.15 || 0.5;
      const y = d3.scaleLinear()
        .domain([yMin - yPad, yMax + yPad])
        .range([innerH, 0]);

      const xVals = data.map(d => +d[cfg.xKey]);
      const xMin = d3.min(xVals), xMax = d3.max(xVals);
      const xRange = xMax - xMin;
      const xPad = xRange * 0.15 || 0.5;
      const x = d3.scaleLinear()
        .domain([xMin - xPad, xMax + xPad])
        .range([0, innerW]);

      g.append('g').attr('transform', `translate(0,${innerH})`)
        .call(d3.axisBottom(x).ticks(10).tickFormat(cfg.xFormat || fmt2).tickSize(-innerH).tickPadding(8))
        .call(s => s.selectAll('.tick line').attr('stroke', '#e2e2e2'))
        .call(s => s.select('.domain').attr('stroke', '#9aa0a6'));

      g.append('g')
        .call(d3.axisLeft(y).ticks(10).tickFormat(cfg.yFormat || fmt2).tickSize(-innerW).tickPadding(6))
        .call(s => s.selectAll('.tick line').attr('stroke', '#efefef'))
        .call(s => s.select('.domain').attr('stroke', '#dcdcdc'));

      const yAvg = d3.mean(yVals), xAvg = d3.mean(xVals);
      g.append('line').attr('x1', 0).attr('x2', innerW).attr('y1', y(yAvg)).attr('y2', y(yAvg))
        .attr('stroke', '#999').attr('stroke-dasharray', '6,4').attr('stroke-width', 1.5);
      g.append('line').attr('x1', x(xAvg)).attr('x2', x(xAvg)).attr('y1', 0).attr('y2', innerH)
        .attr('stroke', '#9aa0a6').attr('stroke-dasharray', '6,4').attr('stroke-width', 1.5);
      g.append('text').attr('x', 6).attr('y', y(yAvg)-6).attr('fill', '#555').attr('font-size', 11)
        .text('Avg Y: ' + (cfg.yFormat || fmt2)(yAvg));
      g.append('text').attr('x', x(xAvg)+6).attr('y', 12).attr('fill', '#555').attr('font-size', 11)
        .text('Avg X: ' + (cfg.xFormat || fmt2)(xAvg));

      const { m, b, r2 } = regression(data.map(d => [+d[cfg.xKey], +d[cfg.yKey]]));
      const xRangePts = [d3.min(xVals), d3.max(xVals)];
      g.append('line')
        .attr('x1', x(xRangePts[0])).attr('y1', y(m*xRangePts[0] + b))
        .attr('x2', x(xRangePts[1])).attr('y2', y(m*xRangePts[1] + b))
        .attr('stroke', '#777').attr('stroke-width', 2).attr('opacity', .95);

      const tip = d3.select('body').append('div').attr('class', 'tooltip').style('display', 'none');

      const size = 30;
      const node = g.selectAll('.team').data(data, d => d.team).join('g').attr('class', 'team')
        .attr('transform', d => `translate(${x(d[cfg.xKey])},${y(d[cfg.yKey])})`)
        .on('mouseenter', function(evt, d){
          const trend = m * d[cfg.xKey] + b;
          const res = d[cfg.yKey] - trend;
          let html = `<strong>${d.team}</strong><br>`;
          html += `${cfg.xLabel}: ${(cfg.xFormat || fmt2)(d[cfg.xKey])}<br>`;
          html += `${cfg.yLabel}: ${(cfg.yFormat || fmt2)(d[cfg.yKey])}<br>`;
          html += `Win%: ${toPct(d.win_pct)}<br>`;
          html += `Δ vs trend: ${(res>=0?'+':'') + fmt2(res)}<br>`;
          
          const qx = +d[cfg.xKey] >= xAvg;
          const qy = +d[cfg.yKey] >= yAvg;
          let quadrant = '';
          if (cfg.quadrantHelp) {
            if (qx && qy) quadrant = '<em>' + cfg.quadrantHelp.topRight + '</em>';
            else if (!qx && qy) quadrant = '<em>' + cfg.quadrantHelp.topLeft + '</em>';
            else if (!qx && !qy) quadrant = '<em>' + cfg.quadrantHelp.bottomLeft + '</em>';
            else quadrant = '<em>' + cfg.quadrantHelp.bottomRight + '</em>';
          } else {
            if (qx && qy) quadrant = '<em>Правый верхний: высокий X, высокий Y</em>';
            else if (!qx && qy) quadrant = '<em>Левый верхний: низкий X, высокий Y</em>';
            else if (!qx && !qy) quadrant = '<em>Левый нижний: низкий X, низкий Y</em>';
            else quadrant = '<em>Правый нижний: высокий X, низкий Y</em>';
          }
          html += quadrant;
          
          tip.style('display','block').html(html);
        })
        .on('mousemove', (evt)=> tip.style('left', (evt.pageX+12)+'px').style('top',(evt.pageY-28)+'px'))
        .on('mouseleave', ()=> tip.style('display','none'));

      node.append('rect')
        .attr('x', -(size/2 + 2)).attr('y', -(size/2 + 2))
        .attr('width', size + 4).attr('height', size + 4)
        .attr('rx', 4).attr('ry', 4)
        .attr('fill', d => (+d[cfg.yKey] >= m*+d[cfg.xKey] + b) ? 'var(--red)' : 'var(--blue)')
        .attr('opacity', .16);

      node.append('image')
        .attr('href', d => d.logoUrl || null)
        .attr('x', -size/2).attr('y', -size/2)
        .attr('width', size).attr('height', size)
        .attr('opacity', .95);

      svg.append('text').attr('x', margin.left + innerW/2).attr('y', height-10)
        .attr('text-anchor', 'middle').attr('fill', '#444').attr('font-size', 12)
        .text(cfg.xLabel);
      svg.append('text').attr('transform', `translate(14, ${margin.top + innerH/2}) rotate(-90)`)
        .attr('text-anchor', 'middle').attr('fill', '#444').attr('font-size', 12)
        .text(cfg.yLabel);

      const legend = panel.append('div').attr('class', 'legend');
      legend.append('span').html(`<span class="swatch avg"></span>Avg X & Y`);
      legend.append('span').html(`<span class="swatch red"></span>Above trend`);
      legend.append('span').html(`<span class="swatch blue"></span>Below trend`);
      legend.append('span').style('margin-left','16px').text('Trend line in gray');

      let corrClass = 'corr-weak', corrLabel = 'Weak';
      if (r2 >= 0.5) { corrClass = 'corr-strong'; corrLabel = 'Strong'; }
      else if (r2 >= 0.25) { corrClass = 'corr-moderate'; corrLabel = 'Moderate'; }
      
      summary.append('span').attr('class', `correlation-badge ${corrClass}`)
        .style('margin-left', '12px')
        .html(`R²=${fmt3(r2)} (${corrLabel})`);

      if (cfg.insight) {
        panel.append('div').style('padding', '8px 14px 10px').style('font-size', '13px')
          .style('color', '#555').style('font-style', 'italic').text('💡 ' + cfg.insight);
      }
    }

    function render() {
      loadData().then(allRows => {
        const charts = [
          {
            xKey: 'sacks_allowed_per_game',
            yKey: 'pass_ints_per_game',
            xLabel: 'Sacks Allowed per Game',
            yLabel: 'Interceptions Thrown per Game',
            title: 'O-Line Protection vs QB Turnovers',
            insight: 'Bad pass protection forces hurried throws, leading to more interceptions',
            metricHelp: '<strong>Sacks vs INTs:</strong> Плохая защита линии = спешные броски = больше перехватов. Связывает работу O-line с ошибками QB.',
            quadrantHelp: {
              topRight: '😱 Полный коллапс карманной защиты (3+ сэка/игру + 1.5+ INT/игру): O-line превратилась в решето, QB под постоянным давлением паникует и бросает в coverage. Команды в этом квадранте теряют 2+ турновера через пас каждую игру. Координатор должен срочно переходить на max protect схемы или quick game',
              topLeft: '🤔 QB сам себе враг (<1.5 сэка, но 1.5+ INT): Линия держит pocket чистым, но квотербек читает защиту как детскую книжку задом наперёд. Классика "герой хочет все решить сам" - форсирует броски в тройное перекрытие. Нужна работа с прогрессиями и checkdown дисциплиной',
              bottomLeft: '✅ Элитная синхронизация (<1.5 сэка + <1 INT): O-line создаёт крепость времени 3+ секунд, QB спокойно проходит прогрессии. Это команды с 65%+ completion и 8+ Y/A - идеальный баланс защиты и принятия решений',
              bottomRight: '⚠️ QB-Houdini под огнём (3+ сэка, но <1 INT): Квотербек как эквилибрист на канате - линия рушится каждый второй snap, но он умудряется выбрасывать мяч безопасно. Долго так не протянуть - либо травма, либо fumbles начнутся от слепых хитов'
            }
          },
          {
            xKey: 'def_ints',
            yKey: 'pass_ints',
            xLabel: 'Defensive Interceptions (Takeaways)',
            yLabel: 'Offensive Interceptions (Giveaways)',
            title: 'Turnover Balance — Defensive INTs vs Offensive INTs',
            insight: 'Teams in top-right = high-variance style (aggressive on both sides). Bottom-left = conservative.',
            metricHelp: '<strong>Баланс потерь:</strong> Верхний правый угол = агрессивный стиль (риск с обеих сторон). Нижний левый = консервативный контроль мяча.',
            quadrantHelp: {
              topRight: '🎲 Казино-футбол (2.5+ DEF INT + 1.5+ OFF INT): Агрессивная защита с постоянным blitz и jump routes создаёт 3+ отбора, но QB тоже рискует на вертикальных маршрутах. Каждая игра - качели с 4+ общими турноверами. Идеально для underdog команд против фаворитов',
              topLeft: '😔 Одностороннее движение (<1.5 DEF INT + 1.5+ OFF INT): Защитные бэки играют в статуи - 30%+ cushion coverage без агрессии на мяче, пока собственный QB раздаёт подарки как Дед Мороз. Turnover differential -1.0 или хуже гарантирован',
              bottomLeft: '🛡️ Шахматная партия (<1.5 DEF INT + <1 OFF INT): Обе стороны играют консервативно - защита в prevent, нападение в ball-control режиме. Игры решаются field position и field goals. Скучно смотреть, но эффективно при лидерстве',
              bottomRight: '🏆 Машина отбора мячей (2.5+ DEF INT + <1 OFF INT): Защита как пираньи - DBs с 15+ PBU агрессивно атакуют catch point, создавая +2.0 turnover margin. При этом offense защищает мяч через короткие timing routes. Формула чемпионов'
            }
          },
          {
            xKey: 'pass_att_per_game',
            yKey: 'punts_per_game',
            xLabel: 'Pass Attempts per Game',
            yLabel: 'Punts per Game',
            title: 'Pass Volume vs Punting Frequency',
            insight: 'Pass-heavy teams often trail in games, leading to more 3-and-outs and punts',
            metricHelp: '<strong>Pass Attempts vs Punts:</strong> Команды с частыми передачами часто проигрывают = больше пантов. Игровая ситуация влияет на статистику.',
            quadrantHelp: {
              topRight: '😔 Отчаянные попытки догнать (40+ пасов + 6+ пантов): Классический garbage time сценарий - отстают на 14+ очков, вынуждены бросать каждый down, но 3-and-out rate выше 40%. Линия устаёт, routes становятся предсказуемыми, защита сидит в nickel/dime и ждёт пас',
              topLeft: '🤔 Беговое упрямство без результата (<30 пасов + 6+ пантов): Пытаются установить run game, но набирают <3.5 Y/A. Защита stackует box с 8+ игроками, но координатор упорно долбит в стену. Time of possession иллюзия - драйвы длятся 3 plays',
              bottomLeft: '🏆 Контроль через power run (<30 пасов + <4 пантов): Доминирующая O-line создаёт 5+ Y/A на земле, контролируя clock и field position. Play-action работает на 12+ Y/A когда используется. Защита соперника устаёт к 4й четверти',
              bottomRight: '🎯 Air raid эффективность (40+ пасов + <4 пантов): Современная passing game машина - quick game, RPOs и YAC создают 7+ Y/A. Third down conversion 45%+, red zone TD rate 60%+. Защита не может подстроиться под темп'
            }
          },
          {
            xKey: 'rush_yac_pct',
            yKey: 'rush_broken_tackle_rate',
            xLabel: 'Rush Yards After Contact %',
            yLabel: 'Broken Tackles per Rush',
            title: 'Physical Running Game — YAC% vs Broken Tackles',
            insight: 'Elite RBs break tackles AND generate yards after contact. Top-right = power runners.',
            metricHelp: '<strong>Физическая игра:</strong> Элитные RB ломают захваты И набирают ярды после контакта. Верхний правый = мощные бегуны.',
            quadrantHelp: {
              topRight: '💪 Человек-танк в backfield (>55% YAC + >0.15 broken tackles/rush): RB как грузовик с реактивным двигателем - contact balance элитный, leg drive после удара добавляет 3+ ярда. Защитники отскакивают как от бетонной стены. Goal line и 3rd&short автоматический first down',
              topLeft: '🏃 Барри Сандерс стиль (<45% YAC + >0.15 broken tackles/rush): Evasion rating 90+ - jump cuts, spin moves делают защитников похожими на пьяных. Но когда ловят - сразу down. Нужны конкретные схемы с outside zone и sweeps',
              bottomLeft: '😔 Бег в никуда (<45% YAC + <0.08 broken tackles/rush): O-line проигрывает в окопах, RB встречает 2+ защитников в backfield. Средний контакт на линии скриммеджа или раньше. Power/inside zone success rate ниже 35%',
              bottomRight: '🎯 Чистые коридоры от O-line (>55% YAC, но <0.08 broken tackles): Линия создаёт автострады - RB набирает 4+ ярда до первого контакта. Но сам бегун "падает от ветра" при касании. Работает пока O-line доминирует, против сильной защиты провал'
            }
          },
          {
            xKey: 'turnover_diff',
            yKey: 'win_pct',
            xLabel: 'Turnover Differential',
            yLabel: 'Win Percentage',
            yFormat: toPct,
            title: 'Most Predictive Stat — Turnover Margin vs Winning',
            insight: 'Turnover differential is the single strongest predictor of wins in football',
            metricHelp: '<strong>Turnover Diff:</strong> Самый сильный предсказатель побед в футболе. Разница отборов-отдач мяча напрямую коррелирует с процентом побед.',
            quadrantHelp: {
              topRight: '🏆 Математика чемпионства (+1.0 TO diff + >60% wins): Каждый турновер worth ~3.5 очка и 14% win probability. Команды здесь выигрывают короткие поля после отборов, конвертируя 70%+ в очки. Defense creates 2.5+ takeaways/game, offense теряет <1.5. Это и есть "complementary football"',
              topLeft: '😔 Героический offense (TO diff <-0.5, но >50% wins): Нападение набирает 400+ Y/G чтобы компенсировать -1.0 turnover margin. QB должен быть MVP-калибра с 35+ TD. Неустойчивая модель - в playoffs такое не работает против хороших защит',
              bottomLeft: '💀 Спираль смерти (TO diff <-0.5 + <40% wins): Отдают 2+ владения/игру через турноверы И не могут забивать. Средняя starting field position opponent 40-yard line. Защита на поле 35+ минут устаёт. Нужен полный rebuild философии ball security',
              bottomRight: '🤔 Загадка недореализации (TO diff >+1.0, но <40% wins): Создают отборы но не капитализируют - scoring после турноверов <30%. Либо special teams disasters (missed FGs, punt returns против), либо red zone offense <40% TD rate. Талант есть, execution хромает'
            }
          },
          {
            xKey: 'pass_comp_pct',
            yKey: 'rec_yds_per_catch',
            xLabel: 'Completion Percentage',
            yLabel: 'Average Yards per Catch',
            title: 'Passing Philosophy — Accuracy vs Depth',
            insight: 'High completion% + low Y/C = dink-and-dunk. Low completion% + high Y/C = vertical passing.',
            metricHelp: '<strong>Философия паса:</strong> Высокий completion% + низкие Y/C = короткие передачи. Низкий completion% + высокие Y/C = глубокий пас.',
            quadrantHelp: {
              topRight: '🎯 Совершенство пасовой игры (>67% comp + >14 Y/C): Идеальный timing с deep shots - play-action на 20+ yards бьёт в 45%+ случаев. QB обрабатывает leverage и throwing windows как хирург. Защита не может сидеть в underneath zones. YPA легко пробивает 8.5+',
              topLeft: '🚀 Вертикальная рулетка (<60% comp, но >14 Y/C): "Fuck it, он где-то там внизу" философия - 50/50 balls и go routes составляют 30%+ плейбука. Работает с elite WRs с catch radius и contested catch ability. PI penalties как бонусные ярды',
              bottomLeft: '😔 Квотербек-калека (<60% comp + <11 Y/C): Не может ни точно бросить, ни растянуть поле. Checkdowns под давлением, sailed passes над головами. Защита сжимает поле в коробку 20x20 ярдов. Third down conversion <30%',
              bottomRight: '🏃 Death by thousand cuts (>67% comp + <11 Y/C): West Coast на стероидах - slants, drags, hitches до тошноты. Ball out in 2.5 seconds, YAC должен быть 50%+ от total yards. Работает пока защита не начнёт jump routes в 4й четверти'
            }
          },
          {
            xKey: 'rush_att_per_game',
            yKey: 'pass_yds_per_att',
            xLabel: 'Rush Attempts per Game',
            yLabel: 'Pass Yards per Attempt',
            title: 'Run Game Impact on Passing Efficiency',
            insight: 'Run-first teams unlock play-action, creating better passing opportunities',
            metricHelp: '<strong>Беговая игра:</strong> Команды с частым бегом разблокируют play-action, создавая лучшие возможности для паса.',
            quadrantHelp: {
              topRight: '🎯 Play-action paradise (25+ rushes + >7.5 Y/A pass): Бег на 4.5+ YPC заставляет LBs честно играть gaps, создавая throwing windows размером с автобус. PA pass success rate 55%+, bootlegs и rollouts дают QB easy reads. Safeties не могут быстро вернуться в deep zones',
              topLeft: '🚀 Air Raid чистой воды (<20 rushes + >7.5 Y/A pass): 11 personnel на 75%+ snaps, 4-5 wide receivers растягивают защиту горизонтально. Quick game и RPO заменяют традиционный run. Работает пока O-line держит 5-man protection',
              bottomLeft: '😔 Полный коллапс offense (<20 rushes + <6.0 Y/A pass): Не могут ни бегать ни пасовать - defense plays с 2-high shells и никого не боится. Negative plays на 25%+ snaps. Third and long каждая серия. Time of possession ниже 27 минут',
              bottomRight: '⚠️ Упрямство без результата (25+ rushes, но <6.0 Y/A pass): Долбят run в stacked boxes из принципа, но play-action не работает потому что defense не респектит бег. Становятся предсказуемыми - run on 1st, pass on 3rd. Никакой explosive plays'
            }
          },
          {
            xKey: 'def_sacks_per_game',
            yKey: 'def_ints_per_game',
            xLabel: 'Defensive Sacks per Game',
            yLabel: 'Defensive Interceptions per Game',
            title: 'Pass Rush vs Coverage — What Creates Turnovers?',
            insight: 'Does pressure create INTs, or does coverage give time for sacks? Both work!',
            metricHelp: '<strong>Pass Rush vs Coverage:</strong> Давление создаёт перехваты или покрытие даёт время для сэков? Оба работают!',
            quadrantHelp: {
              topRight: '🏆 Legion of Boom 2.0 (3+ sacks + 1.5+ INT/game): Pass rush в 2.5 секунд + coverage держит 3.5+ секунд = QB кошмар. Pressure rate 35%+ заставляет поспешные броски в coverage. Third down stops на 70%+. Защита забирает игры',
              topLeft: '🎯 Coverage sack машина (<2 sacks, но 1.5+ INT): DBs как клей - receivers не открываются 4+ секунды, QB держит мяч и либо бросает в coverage либо scrambles. Zone coverage disguise создаёт confusion. Red zone INT rate зашкаливает',
              bottomLeft: '😔 Швейцарский сыр (<2 sacks + <1 INT): Rush не доходит, coverage не держит - QB completion 70%+ с clean pocket. Quick game разрывает на части. Offense противника конвертирует 50%+ third downs. 400+ yards allowed норма',
              bottomRight: '💪 Блицкриг без награды (3+ sacks, но <1 INT): Edge rushers доминируют с <2.5 sec pressure, но DBs играют off-coverage. Sacks приходят до того как routes развиваются для INT. Hot routes и screens наказывают агрессию'
            }
          },
          {
            xKey: 'explosive_plays_per_game',
            yKey: 'punts_per_game',
            xLabel: '20+ Yard Plays per Game',
            yLabel: 'Punts per Game',
            title: 'Explosive Plays vs Punting',
            insight: 'Big plays sustain drives and reduce punting frequency. Explosive offense = fewer punts.',
            metricHelp: '<strong>Большие игры:</strong> Взрывные розыгрыши поддерживают драйвы и уменьшают частоту пантов. Взрывное нападение = меньше пантов.',
            quadrantHelp: {
              topRight: '🤔 Джекилл и Хайд offense (4+ explosive + 6+ punts): Home run или strikeout - explosive rate 15%+ но success rate <40%. Вертикальные shots создают 2-3 big plays, но между ними идут three-and-outs. Защита adjusts к 2nd half и shut down происходит',
              topLeft: '😔 Анемичное нападение (<2 explosive + 6+ punts): Максимальная игра 15 ярдов, defense сжимает поле без страха deep ball. Средняя длина драйва 4 plays. Red zone appearances <2 за игру. Punter - MVP команды по snaps',
              bottomLeft: '🎯 Методичный марш (<2 explosive, но <4 punts): Nickel and dime путь - 12+ play drives съедают 7+ минут. Third down efficiency 50%+ на коротких дистанциях. Ball control философия с 32+ минутами владения',
              bottomRight: '🏆 Cheat code offense (4+ explosive + <4 punts): Explosive plays на 15%+ snaps И поддерживают drives между ними. Chunk plays в критические моменты - 3rd&7 конвертируют в 25-yarder. Scoring на 70%+ владений'
            }
          },
          {
            xKey: 'pass_rush_ratio',
            yKey: 'win_pct',
            xLabel: 'Pass/Rush Attempt Ratio',
            yLabel: 'Win Percentage',
            yFormat: toPct,
            title: 'Game Script Analysis — Pass/Run Balance vs Wins',
            insight: 'Do teams pass because they\'re losing? Or run because they\'re winning? Causation vs correlation.',
            metricHelp: '<strong>Игровая ситуация:</strong> Команды пасуют, потому что проигрывают, или бегут, потому что выигрывают? Причинность vs корреляция.',
            quadrantHelp: {
              topRight: '🎯 Modern offensive juggernaut (>1.8 ratio + >60% wins): Pass-first BY CHOICE, не necessity. 65%+ pass rate даже при лидерстве. EPA/pass в топ-10 лиги. Quick strike capability с 2-minute offense в любой момент. Defense respects pass, создавая draw/screen opportunities',
              topLeft: '🏃 Ground and pound winners (<1.3 ratio + >60% wins): Физическое доминирование - 30+ rushes контролируют clock и деморализуют defense. Выигрывают time of possession 34+ минут. 4я четверть принадлежит им когда defense устала',
              bottomLeft: '😔 Offensive futility (<1.3 ratio + <40% wins): Пытаются run-first, но получают 3.0 Y/A. Не могут перейти на pass потому что play-action не работает без run threat. Stuck между стульями - никакая философия не работает',
              bottomRight: '⚠️ Chasing games syndrome (>1.8 ratio + <40% wins): Отстают 10+ очков к halftime в 75%+ игр. Вынужденный abandon the run создаёт предсказуемость. Pass rush pins ears back, sack rate взлетает до 10%+. Garbage time stats misleading'
            }
          },
          {
            xKey: 'fg_pct',
            yKey: 'win_pct',
            xLabel: 'Field Goal %',
            yLabel: 'Win Percentage',
            yFormat: toPct,
            title: 'Kicking Accuracy vs Winning',
            insight: 'Games are won by 3 points. Field goal accuracy matters more in close games.',
            metricHelp: '<strong>Field Goal %:</strong> Процент попаданий по воротам. Игры выигрываются 3 очками - точность киккера важна в близких матчах.',
            quadrantHelp: {
              topRight: '🎯 Clutch kicker advantage (>85% FG + >60% wins): Автоматический внутри 50 ярдов, 60%+ с 50+. В close games (≤7 очков) конвертируют 90%+ FG attempts. "Ice in veins" в 4й четверти. Те самые 3 очка решают 2-3 игры в сезон',
              topLeft: '💪 TD or nothing mentality (<75% FG, но >60% wins): Red zone TD rate 65%+ делает FG неважными. Идут на 4th down внутри 5 вместо чип-шота. Агрессивная философия окупается через momentum и деморализацию defense',
              bottomLeft: '😔 Double whammy (<75% FG + <40% wins): Киккер стоит 3-6 очков за игру И offense не может компенсировать touchdowns. Missed FGs убивают momentum. Соперники начинают drives с лучшей позиции после промахов',
              bottomRight: '🤔 Wasted weapon (>85% FG, но <40% wins): Киккер - единственное светлое пятно, но offense приводит его только для 50+ yarders после stalled drives. Не могут дойти до red zone. Defense сдаёт 30+ очков, делая FGs бессмысленными'
            }
          },
          {
            xKey: 'punt_net_avg',
            yKey: 'def_ints_per_game',
            xLabel: 'Punt Net Average (Yards)',
            yLabel: 'Defensive INTs per Game',
            title: 'Field Position Battle — Punting vs Defensive Turnovers',
            insight: 'Better punting pins opponents deep, forcing riskier throws and creating turnover opportunities.',
            metricHelp: '<strong>Punt Net vs DEF INTs:</strong> Лучший пантинг прижимает соперников глубоко, заставляя рисковать пасами и создавая перехваты.',
            quadrantHelp: {
              topRight: '🏆 Field position dominance (>43 net + 1.5+ INT): Coffin corner artist прижимает к своей 20, заставляя conservative play-calling. Длинные поля = больше pass attempts = больше INT opportunities. Defense начинает 60%+ drives с opponent territory <25',
              topLeft: '🎯 Coverage overcomes position (<38 net, но 1.5+ INT): Пантер бьёт touchbacks или line drives, но elite DBs создают turnovers независимо от позиции. Pattern matching и disguised coverage создают confusion даже на коротких полях',
              bottomLeft: '😔 Special teams disaster (<38 net + <1 INT): Пантер outkicks coverage или shanks под давлением. Opponents начинают с 35+ yard line в среднем. Defense не может capitalize даже на хорошей позиции. Hidden yardage убивает',
              bottomRight: '🤔 Wasted field position (>43 net, но <1 INT): Пантер делает свою работу - hang time 4.5+ секунд, внутри 20 на 45%+ attempts. Но defense играет soft coverage, давая easy completions underneath. Field position advantage испаряется за 2 plays'
            }
          },
          {
            xKey: 'punts_in_20_pct',
            yKey: 'def_sacks_per_game',
            xLabel: 'Punts Inside 20 (%)',
            yLabel: 'Defensive Sacks per Game',
            title: 'Special Teams Impact — Punt Placement vs Defensive Pressure',
            insight: 'Coffin-corner punts force conservative play-calling, giving pass rush more opportunities.',
            metricHelp: '<strong>Punts in 20:</strong> Панты внутрь 20 заставляют консервативный плейколлинг, давая pass rush больше возможностей.',
            quadrantHelp: {
              topRight: '🏆 Complementary football (>45% inside-20 + 3+ sacks): Coffin corner specialist + elite pass rush = nightmare combo. Backed up offenses вынуждены max protect, оставляя fewer receivers. Predictable play-calling из глубины создаёт pin-your-ears-back rushing',
              topLeft: '💪 Pass rush carries team (<30% inside-20, но 3+ sacks): Edge rushers с <2.3 sec pressure не нуждаются в помощи позиции. Win rate 25%+ независимо от field position. Stunts и twists создают free rushers даже с short fields',
              bottomLeft: '😔 No pressure points (<30% inside-20 + <2 sacks): Не могут ни прижать пантами ни создать pass rush. Opponents получают rhythm throws с clean pockets. Average starting position midfield даёт короткие поля для scoring',
              bottomRight: '🤔 Positional advantage wasted (>45% inside-20, но <2 sacks): Пантер - weapon, но pass rush не может воспользоваться. Opponents используют quick game и screens чтобы нейтрализовать длинное поле. 3-step drops не дают время для sacks'
            }
          },
          {
            xKey: 'total_off_tds',
            yKey: 'xp_pct',
            xLabel: 'Total Offensive Touchdowns',
            yLabel: 'Extra Point %',
            title: 'Scoring Frequency vs XP Accuracy',
            insight: 'High-scoring teams attempt more XPs. Does volume increase pressure and lead to more misses?',
            metricHelp: '<strong>TDs vs XP%:</strong> Высокорезультативные команды пытаются больше XP. Объём увеличивает давление и ведёт к большим промахам?',
            quadrantHelp: {
              topRight: '🎯 Scoring machine perfection (35+ TDs + >95% XP): Red zone TD rate 65%+, explosive plays для 6+ TDs с 50+ yards. Киккер в rhythm с 40+ attempts, automatic после celebrations. Total scoring 30+ PPG легко',
              topLeft: '😔 Grinding for points (<25 TDs, но >95% XP): Борются за каждый TD, settling для FGs часто. Киккер sharp из-за малого объёма и важности каждого очка. Games decided by <7 points. Every XP критичен',
              bottomLeft: '💀 Offensive disaster (<25 TDs + <90% XP): Не могут ни забить TD ни конвертировать когда забивают. Оставляют 2-4 очка на поле от missed XPs. В close games эти очки haunting. Momentum killers после редких TDs',
              bottomRight: '⚠️ Volume pressure cracks (35+ TDs, но <90% XP): High-octane offense, но киккер wilts под объёмом. Fatigue или mental pressure от частых attempts. Теряют 3-5 XP за сезон = potential tie-breakers в standings'
            }
          },
          {
            xKey: 'sack_rate',
            yKey: 'qb_rating',
            xLabel: 'Sack Rate (%)',
            yLabel: 'QB Rating',
            title: 'QB Protection vs Efficiency',
            insight: 'Better pass protection leads to better QB performance. Measures offensive line impact on QB success.',
            metricHelp: '<strong>Sack Rate vs QB Rating:</strong> Лучшая защита паса = лучшая работа QB. Измеряет влияние O-line на успех квотербека.',
            quadrantHelp: {
              topRight: '😱 Escape artist excellence (>8% sack rate + >95 rating): QB - Houdini с pocket presence, превращает broken plays в positive yards. Scramble ability создаёт 5+ секунд для coverage-beaters. Sacks случаются, но между ними идут explosive plays на broken coverage',
              topLeft: '🏆 Clean pocket clinic (<5% sack rate + >95 rating): Fortress O-line даёт 3.5+ clean seconds, QB surgical с reads. Quick release <2.5 sec на timing routes. Play-action success rate 60%+ с такой защитой. Классическая pocket passing',
              bottomLeft: '😔 QB проблема, не O-line (<5% sack rate + <85 rating): Линия держит, но QB видит ghosts - happy feet, bailing from clean pockets. Пропускает open receivers, форсирует в coverage. Нужна mental conditioning или замена',
              bottomRight: '💀 Turnstile protection (>8% sack rate + <85 rating): O-line - вращающаяся дверь, QB shell-shocked к середине сезона. Internal clock сломан, механика разваливается под pressure. Strip sacks и intentional grounding как норма'
            }
          },
          {
            xKey: 'def_ints_per_game',
            yKey: 'win_pct',
            xLabel: 'Defensive INTs per Game',
            yLabel: 'Win Percentage',
            yFormat: toPct,
            title: 'Defensive Turnover Creation vs Winning',
            insight: 'Defense wins championships? Creating turnovers is one of the strongest predictors of winning.',
            metricHelp: '<strong>DEF INTs vs Wins:</strong> Защита выигрывает чемпионаты? Создание перехватов - один из сильнейших предсказателей побед.',
            quadrantHelp: {
              topRight: '🏆 Defense wins championships (1.5+ INT + >60% wins): Ball-hawking DBs создают 25+ turnovers за сезон. Short fields после INT конвертируют в 10+ PPG. Momentum swings от pick-6s и red zone INTs. Clutch INTs в 4й четверти seal games',
              topLeft: '💪 Offensive juggernaut (<1 INT + >60% wins): Забивают 30+ PPG, делая turnovers менее важными. Explosive offense компенсирует отсутствие defensive playmaking. Но в playoffs против elite defenses это не работает',
              bottomLeft: '😔 Defensive liability (<1 INT + <40% wins): DBs играют scared - soft coverage, не attacking ball at catch point. QBs имеют 70%+ completion против них. Без turnovers defense на поле 33+ минут и ломается в 4й четверти',
              bottomRight: '🤔 Empty calories INTs (1.5+ INT, но <40% wins): Создают turnovers но offense идёт 3-and-out после них. Scoring после turnovers <20%. INTs в garbage time когда игра решена. Offense не может capitalize на defensive efforts'
            }
          },
          {
            xKey: 'pass_int_pct',
            yKey: 'win_pct',
            xLabel: 'Interception Rate (%)',
            yLabel: 'Win Percentage',
            yFormat: toPct,
            title: 'Ball Security vs Winning',
            insight: 'Teams that protect the ball win games. Lower INT rate = more wins.',
            metricHelp: '<strong>INT Rate vs Wins:</strong> Команды, защищающие мяч, выигрывают игры. Низкий процент перехватов = больше побед.',
            quadrantHelp: {
              topRight: '😱 Gunslinger paradox (>3% INT rate + >60% wins): QB бросает 20+ INTs но 40+ TDs компенсируют. Big play ability (15+ Y/C) превышает turnover негатив. Playing with fire - работает в regular season, burns в playoffs',
              topLeft: '🏆 Smart football wins (<1.5% INT rate + >60% wins): Game manager excellence - защищают мяч, контролируют clock, выигрывают field position. Boring но effective. Third down efficiency через ball control. Championships built here',
              bottomLeft: '😔 Conservative futility (<1.5% INT rate + <40% wins): Защищают мяч но не могут двигаться - dink and dunk без YAC. Risk aversion становится predictability. Defense sits on short routes. No explosive plays = no scoring',
              bottomRight: '💀 Turnover machine (>3% INT rate + <40% wins): Каждый 30й пас - подарок сопернику. Red zone INTs, pick-6s убивают momentum. QB forcing into tight windows без arm talent. Coaching нужно переоценить risk/reward'
            }
          },
          {
            xKey: 'pass_yds_per_att',
            yKey: 'rush_explosive_rate',
            xLabel: 'Pass Yards per Attempt',
            yLabel: 'Rush Explosive Play Rate (%)',
            title: 'Explosive Offense Philosophy',
            insight: 'Do teams with explosive passing also have explosive running? Or specialize in one?',
            metricHelp: '<strong>Pass vs Rush Explosives:</strong> Команды с взрывным пасом также имеют взрывной бег? Или специализируются на одном?',
            quadrantHelp: {
              topRight: '💥 Total chaos offense (>7.5 Y/A pass + >8% rush explosive): Кошмар defensive coordinators - must defend every blade of grass. 20+ yard plays от BOTH run и pass на 20%+ drives. Score от anywhere на field в 2 plays',
              topLeft: '🏃 Ground explosion specialists (<6.5 Y/A pass + >8% rush explosive): Outside zone с speed backs hitting home runs. Но passing game - checkdowns и screens. Defenses load box после big runs, shutting down repeatability',
              bottomLeft: '😔 Methodical grind (<6.5 Y/A pass + <5% rush explosive): Death by thousand papercuts - 4 yard gains до nausea. No plays over 20 yards. Требуют 15+ play drives для scoring. One penalty kills entire possession',
              bottomRight: '🚀 Vertical pass, patient run (>7.5 Y/A pass + <5% rush explosive): Deep shots и play-action создают explosive passing. Run game - ball control между bombs. Gap/power schemes для 3-4 yards. Predictable но effective если QB accurate deep'
            }
          },
          {
            xKey: 'pass_yds_per_att',
            yKey: 'rush_yds_per_att',
            xLabel: 'Pass Yards per Attempt',
            yLabel: 'Rush Yards per Attempt',
            title: 'Offensive Efficiency Balance',
            insight: 'Balanced efficiency vs specialized offense. Top-right = elite at both. Others = one-dimensional.',
            metricHelp: '<strong>Pass Y/A vs Rush Y/A:</strong> Сбалансированная эффективность vs специализированное нападение. Верхний правый = элита в обоих.',
            quadrantHelp: {
              topRight: '🏆 Unstoppable force (>7.5 pass Y/A + >4.5 rush Y/A): Pick your poison defense - stack box? 8.5+ Y/A passing. Play coverage? 5+ YPC на ground. Perfectly balanced как Thanos. Red zone TD rate 70%+ от multiple formations',
              topLeft: '🏃 Ground and pound identity (<6.5 pass Y/A + >4.5 rush Y/A): Физическое доминирование с 5+ YPC, но passing game exists только для play-action. Работает пока не отстают by 14+. Clock control masters но limited comeback ability',
              bottomLeft: '😔 Offensive wasteland (<6.5 pass Y/A + <3.8 rush Y/A): Не могут ничего - ни stretch field ни control line. Predictable by situation - obvious pass на 3rd&long, obvious run на 3rd&short. Scoring drives - accidents. Under 20 PPG guaranteed',
              bottomRight: '🚀 Modern passing attack (>7.5 pass Y/A + <3.8 rush Y/A): Spread formations, RPOs, quick game на 8+ Y/A. Rush - afterthought для occasional draws. Работает в shootouts но struggles в cold/wind. Playoff liability без balance'
            }
          },
          {
            xKey: 'td_per_play',
            yKey: 'win_pct',
            xLabel: 'Touchdowns per Play',
            yLabel: 'Win Percentage',
            yFormat: toPct,
            title: 'Red Zone Scoring Efficiency vs Winning',
            insight: 'Finishing drives with TDs (not FGs) wins games. Measures red zone effectiveness.',
            metricHelp: '<strong>TD per Play:</strong> Финиш драйвов тачдаунами (не FG) выигрывает игры. Измеряет эффективность красной зоны.',
            quadrantHelp: {
              topRight: '🏆 Red zone assassins (>0.035 TD/play + >60% wins): Конвертируют 70%+ red zone trips в 6 points. Fade routes, RPOs, QB sneaks - arsenal готов. Settling для FG - редкость. 28+ PPG через efficiency не volume',
              topLeft: '💪 Defensive fortress (<0.025 TD/play + >60% wins): Выигрывают 17-14 тип игр. Defense создаёт short fields но offense kicks FGs. Ugly wins но wins nonetheless. Weather games - их specialty',
              bottomLeft: '😔 Red zone allergic (<0.025 TD/play + <40% wins): Drives умирают inside 20 - penalties, sacks, drops. FG attempts вместо TDs = losing football. Red zone TD% ниже 40%. Оставляют 4 points per trip минимум',
              bottomRight: '🤔 Empty calories TDs (>0.035 TD/play + <40% wins): Забивают в garbage time или дают 35+ defensively. No lead safe с такой защитой. Quick strike TDs но defense на поле сразу возвращает. Time of possession кошмар'
            }
          },
          {
            xKey: 'def_sacks_per_game',
            yKey: 'pass_comp_pct',
            xLabel: 'Defensive Sacks per Game',
            yLabel: 'Team Completion %',
            title: 'Defensive Pressure Impact',
            insight: 'Does generating sacks correlate with opponent incompletions? Pass rush vs coverage.',
            metricHelp: '<strong>DEF Sacks vs Completion%:</strong> Генерация сэков коррелирует с incompletions соперника? Pass rush vs coverage.',
            quadrantHelp: {
              topRight: '🤔 Quick game neutralizer (3+ DEF sacks + >65% OFF comp%): Defense generates pressure но offense counters с <2.3 sec release quick game. Slants, hitches, screens negate pass rush. Sacks come на obvious passing downs только',
              topLeft: '✅ Clean pocket paradise (<2 DEF sacks + >65% OFF comp%): O-line - Great Wall, QB has picnic в pocket. Может пройти full progressions, найти checkdowns. 7-step drops без страха. Completion% inflated от времени',
              bottomLeft: '💪 Coverage drives incompletions (<2 DEF sacks + <60% OFF comp%): Sticky coverage заставляет contested throws. Windows закрыты, QB форсирует. Pattern matching и disguised zones создают confusion без blitzing',
              bottomRight: '🏆 Total defensive dominance (3+ DEF sacks + <60% OFF comp%): Pass rush в 2.5 sec + tight coverage = offensive nightmare. QB под pressure бросает off-platform в coverage. Batted passes, strips sacks common. Third down - automatic punt'
            }
          },
          {
            xKey: 'rush_att_per_game',
            yKey: 'pass_ints_per_game',
            xLabel: 'Rush Attempts per Game',
            yLabel: 'INTs Thrown per Game',
            title: 'Ball Control Strategy',
            insight: 'Running teams protect the ball better. Time of possession = fewer risky throws = fewer turnovers.',
            metricHelp: '<strong>Rush Att vs INTs:</strong> Беговые команды лучше защищают мяч. Контроль владения = меньше рискованных бросков = меньше перехватов.',
            quadrantHelp: {
              topRight: '⚠️ Run-heavy but reckless (25+ rushes + 1.5+ INT): Establish run с 30+ attempts но play-action backfires. QB forcing deep shots off PA fakes в loaded coverage. Predictable formations telegraph intentions. Run success не translating в passing efficiency',
              topLeft: '🚀 Air raid precision (<20 rushes + <1 INT): Pure passing attack с quick release и hot routes. Ball out в 2.5 sec before pressure. High percentage throws, avoiding risky deep shots. System QB executing perfectly',
              bottomLeft: '😔 Conservative passing (<20 rushes + <1 INT): Forced в one-dimensional passing но protecting ball. Checkdowns и underneath routes только. No explosive potential. Nickel and diming без touchdown threats',
              bottomRight: '🏆 Ball control mastery (25+ rushes + <1 INT): Time of possession 33+ минут, limiting opponent opportunities. Play-action на 50/50 splits deadly. QB под no pressure в obvious pass situations. Formula championship teams'
            }
          },
          {
            xKey: 'rec_catches',
            yKey: 'rec_yds_per_catch',
            xLabel: 'Total Receptions',
            yLabel: 'Yards per Catch',
            title: 'Receiving Efficiency vs Volume',
            insight: 'High-volume short passing (bottom-right) vs low-volume deep passing (top-left). West Coast vs vertical.',
            metricHelp: '<strong>Receptions vs Y/C:</strong> Высокообъёмный короткий пас (нижний правый) vs низкообъёмный глубокий (верхний левый). West Coast vs vertical.',
            quadrantHelp: {
              topRight: '🚀 Volume vertical attack (300+ catches + >14 Y/C): Rare combination - high volume И deep passing. Multiple receivers с 15+ Y/C averages. Spread formations stretching field both ways. 400+ pass attempts feeding everyone',
              topLeft: '🎯 Boom or bust vertical (<250 catches + >14 Y/C): Low volume deep shots - 20%+ targets are 20+ yards downfield. Go routes, posts, corners dominate. Требует elite QB arm и WR speed. High variance week-to-week',
              bottomLeft: '😔 Passing game dysfunction (<250 catches + <11 Y/C): Cannot complete passes efficiently ИЛИ stretch field. Routes breaking at 5-7 yards. No YAC creation. Defense sitting on everything. Under 200 passing yards norm',
              bottomRight: '🏃 Death by papercuts (300+ catches + <11 Y/C): West Coast на maximum - 400+ completions на season но average 8 yards. Ball control через volume не efficiency. Требует perfect execution и YAC masters'
            }
          },
          {
            xKey: 'sack_rate',
            yKey: 'pass_comp_pct',
            xLabel: 'Sack Rate (%)',
            yLabel: 'Completion %',
            title: 'QB Accuracy Under Pressure',
            insight: 'Can QBs maintain accuracy when facing pressure? Mental toughness and pocket presence test.',
            metricHelp: '<strong>Sack Rate vs Completion%:</strong> QB поддерживают точность под давлением? Тест ментальной силы и работы в кармане.',
            quadrantHelp: {
              topRight: '😱 Pressure-proof QB (>8% sack rate + >65% comp): Rare breed - maintains mechanics под chaos. Climbs pocket, keeps eyes downfield во время contact. Internal clock adjusted для pressure. Completion% не падает despite hits',
              topLeft: '🏆 Perfect environment (<5% sack rate + >65% comp): Fortress protection + accurate QB = offensive excellence. Clean pocket на 75%+ dropbacks. Can work through full progression. Deep balls и touch passes on time',
              bottomLeft: '😔 Accuracy issues persist (<5% sack rate + <60% comp): Protection есть но QB не может hit broadside of barn. Sailing throws, dirt balls с clean feet. Mechanical issues или processing problems. Нужен QB coach или bench',
              bottomRight: '💀 Shell-shocked disaster (>8% sack rate + <60% comp): Постоянное pressure сломало QB mentally. Happy feet, bailing early, seeing ghosts. Accuracy mechanics destroyed от anticipating hits. Confidence shattered by Week 8'
            }
          },
          {
            xKey: 'def_forced_fum',
            yKey: 'def_fum_rec',
            xLabel: 'Fumbles Forced',
            yLabel: 'Fumbles Recovered',
            title: 'Fumble Recovery Luck',
            insight: 'Fumbles are 50/50 balls. Teams above trend = lucky, below trend = unlucky. Regression candidate.',
            metricHelp: '<strong>Forced vs Recovered:</strong> Фамблы - 50/50 мячи. Команды выше тренда = удачливые, ниже = неудачливые. Кандидаты на регрессию.',
            quadrantHelp: {
              topRight: '🍀 Luck magnets (15+ forced + 10+ recovered): Recovery rate >60% - статистическая аномалия. Bounce luck, hustle to ball, или home cooking? Strip-sack specialists И gang tackling создают И отбирают. Regression coming но ride wave',
              topLeft: '😔 Statistical impossibility (<10 forced + 10+ recovered): Как это вообще? Отбирают чужие forced fumbles? Или scorer ошибается? Проверьте data integrity. Если real - максимальная удача без усилий',
              bottomLeft: '⚠️ Passive tackling (<10 forced + <5 recovered): Arm tackles, no punch attempts на ball. Защитники focused на stopping не stripping. Conservative coaching philosophy. Leaving plays на field каждую игру',
              bottomRight: '😱 Cursed recovery rate (15+ forced, но <5 recovered): Punch out masters но ball bounces к opponents. <35% recovery rate - due для positive regression. Peanut Tillman punches без Lucky recoveries. Heartbreaking near-turnovers'
            }
          },
          {
            xKey: 'rec_catches',
            yKey: 'drop_rate',
            xLabel: 'Total Receptions',
            yLabel: 'Drop Rate (%)',
            title: 'Receiving Corps Reliability',
            insight: 'Do high-volume receivers drop more passes? Fatigue vs concentration at high workloads.',
            metricHelp: '<strong>Receptions vs Drop Rate:</strong> Принимающие с высоким объёмом теряют больше передач? Усталость vs концентрация при высоких нагрузках.',
            quadrantHelp: {
              topRight: '⚠️ Volume fatigue showing (300+ catches + >6% drops): High usage создаёт concentration lapses. 4я четверть drop rate doubles. Cold weather games - disaster. WRs need JUGS machine overtime или rotation для rest',
              topLeft: '😔 Stone hands syndrome (<250 catches + >6% drops): Cannot catch cold в Miami. Open drops, contested drops, всё drops. QB trust eroding - stops looking their way. Need new receiving corps ASAP',
              bottomLeft: '✅ Limited but reliable (<250 catches + <3% drops): Low volume но sure hands когда called upon. Role players doing job. Third down security blankets. Not spectacular но dependable',
              bottomRight: '🏆 Elite hands factory (300+ catches + <3% drops): Catching everything - behind, high, low, contested. QB trusts в tight windows. YAC starts с secure catches. 50/50 balls становятся 70/30 с такими руками'
            }
          },
          {
            xKey: 'def_deflections',
            yKey: 'def_ints',
            xLabel: 'Pass Deflections',
            yLabel: 'Defensive Interceptions',
            title: 'Defensive Playmaking',
            insight: 'Creating INTs requires getting hands on the ball first. Coverage quality indicator.',
            metricHelp: '<strong>Deflections vs INTs:</strong> Создание перехватов требует сначала достать мяч руками. Индикатор качества покрытия.',
            quadrantHelp: {
              topRight: '🏆 Ball-hawk paradise (40+ deflections + 15+ INTs): DBs с elite ball skills - high point, track, catch. 40%+ deflection-to-INT rate. Practice tip drills paying off. Creating turnovers через aggression И execution',
              topLeft: '🎯 Opportunistic hunters (<25 deflections + 15+ INTs): Не много attempts на ball но capitalize когда делают. Reading QB eyes, jumping routes perfectly. Quality over quantity approach. Disguised coverage creating easy INTs',
              bottomLeft: '😔 Coverage breakdown (<25 deflections + <10 INTs): Cannot get hands on balls - always step behind. Cushion too soft, breaks too late. QBs completing at will. Need faster DBs или scheme change',
              bottomRight: '⚠️ Butterfingers DBs (40+ deflections + <10 INTs): Stone hands disease - hitting balls но не catching. Would-be All-Pros если could catch. 20% conversion rate criminal. Need JUGS machine для DBs срочно'
            }
          },
          {
            xKey: 'rush_broken_tackles',
            yKey: 'rush_tds',
            xLabel: 'Broken Tackles (Rushing)',
            yLabel: 'Rushing Touchdowns',
            title: 'Run Game Physicality',
            insight: 'Power runners break tackles AND score TDs. Physical dominance at the goal line.',
            metricHelp: '<strong>Broken Tackles vs Rush TDs:</strong> Мощные бегуны ломают захваты И забивают TD. Физическое доминирование на линии ворот.',
            quadrantHelp: {
              topRight: '💪 Goal line bulldozers (50+ broken + 15+ rush TDs): Power backs с elite contact balance. Red zone conversion 75%+ on ground. Defenders bounce off в goal line situations. 4th&1 automatic. Physical dominance wearing down defenses',
              topLeft: '🏃 Finesse finishers (<30 broken + 15+ rush TDs): Speed to edge или perfect vision между tackles. Not breaking tackles но avoiding them. Outside zone и sweeps в red zone. TDs от scheme не power',
              bottomLeft: '😔 No push anywhere (<30 broken + <8 rush TDs): Cannot move pile или break arm tackles. Goal line stuffed regularly. Settling для pass или FG в red zone. RBs going down на first contact',
              bottomRight: '⚠️ Between 20s warrior (50+ broken + <8 rush TDs): Breaking tackles between 20s но не finishing. Red zone efficiency crashes - predictable, no passing threat. Drive-killing penalties или fumbles near goal line'
            }
          },
          {
            xKey: 'punt_net_avg',
            yKey: 'win_pct',
            xLabel: 'Punt Net Average (Yards)',
            yLabel: 'Win Percentage',
            yFormat: toPct,
            title: 'Special Teams Field Position Impact',
            insight: 'Better punting creates better field position. Hidden yards that contribute to winning.',
            metricHelp: '<strong>Punt Net vs Win%:</strong> Лучший пантинг создаёт лучшую позицию поля. Скрытые ярды, которые способствуют победам.',
            quadrantHelp: {
              topRight: '🏆 Hidden yardage wins (>42 net + >60% wins): Field position battle выигран каждую игру. 10+ yard advantage в starting position. Complementary football - punt coverage elite too. Those 40 hidden yards = 3-6 points difference',
              topLeft: '💪 Overcoming bad punts (<38 net + >60% wins): Offense/defense так dominant что field position не важна. Scoring от anywhere, stopping everyone. Но в close playoff games это vulnerability',
              bottomLeft: '😔 Field position kills (<38 net + <40% wins): Starting -10 yards behind каждый drive. Opponents getting short fields. Punter outkicking coverage или shanking под pressure. Hidden yardage costing games',
              bottomRight: '🤔 Wasted weapon (>42 net + <40% wins): Elite punter flipping field но offense/defense не capitalizing. Perfect coffin corners followed by 80-yard TD drives allowed. Special teams excellence в vacuum'
            }
          },
          {
            xKey: 'pass_att_per_game',
            yKey: 'sacks_allowed_per_game',
            xLabel: 'Pass Attempts per Game',
            yLabel: 'Sacks Allowed per Game',
            title: 'Pass Protection Breakdown Rate',
            insight: 'More dropbacks = more sacks? Pass-heavy offense fatigue on offensive line.',
            metricHelp: '<strong>Pass Att vs Sacks Allowed:</strong> Больше дропбэков = больше сэков? Усталость пасовой защиты O-line при частых пасах.',
            quadrantHelp: {
              topRight: '😱 Volume breakdown (40+ attempts + 3+ sacks): O-line gassed by 4th quarter от pass protection. 600+ pass block snaps wearing down. Predictable passing situations. Defense teeing off с exotic pressures. Sack rate climbing каждый quarter',
              topLeft: '⚠️ Cannot protect period (<30 attempts + 3+ sacks): Even limited passing приводит к sacks. 10%+ sack rate disaster. Quick game не helping. O-line needs complete overhaul - scheme, personnel, или both',
              bottomLeft: '🏃 Run-first protection (<30 attempts + <1.5 sacks): Limited pass attempts = fresh O-line когда passing. Play-action с 8-man box easier to block. Low sack rate от selective passing не elite protection',
              bottomRight: '🏆 Elite pass pro unit (40+ attempts + <1.5 sacks): Brick wall holding up под volume. <4% sack rate despite 600+ dropbacks. Perfect communication, slide protection, picking up stunts. QB comfortable taking deep shots'
            }
          },
          {
            xKey: 'def_tackles',
            yKey: 'def_sacks',
            xLabel: 'Total Tackles',
            yLabel: 'Defensive Sacks',
            title: 'Defensive Tackle Efficiency',
            insight: 'High tackle teams chase plays. Low tackle + high sack teams make disruptive plays.',
            metricHelp: '<strong>Tackles vs Sacks:</strong> Команды с большим числом tackles гонятся за игрой. Низкие tackles + высокие sacks = разрушительные игры.',
            quadrantHelp: {
              topRight: '💪 Swarm defense (800+ tackles + 40+ sacks): Gang tackling И pass rush dominance. Multiple hats to ball каждый snap. Pursuit angles elite. Creating negative plays через numbers И penetration. Exhausting но effective',
              topLeft: '🏆 Disruptive front (< 700 tackles + 40+ sacks): TFLs и sacks stopping plays behind LOS. No need for many tackles когда offense going backwards. 3-and-outs через penetration. Ultimate efficiency',
              bottomLeft: '😔 Ghost defense (<700 tackles + <30 sacks): Missing tackles, no pressure, offense doing whatever. Players out of position или lacking effort. 30+ first downs allowed. Offensive coordinators licking lips',
              bottomRight: '⚠️ Chase mode (<800 tackles + <30 sacks): Always tackling 5+ yards downfield. No penetration, reactive только. Offense dictating tempo. Bend-but-not-break становится break eventually. Need scheme change'
            }
          },
          {
            xKey: 'yds_per_play',
            yKey: 'explosive_plays_per_game',
            xLabel: 'Yards per Play',
            yLabel: 'Explosive Plays (20+) per Game',
            title: 'Offensive Consistency vs Explosiveness',
            insight: 'Consistent efficient offense (left) vs boom-or-bust explosive offense (right).',
            metricHelp: '<strong>Y/Play vs Explosive Plays:</strong> Последовательное эффективное нападение (слева) vs boom-or-bust взрывное (справа).',
            quadrantHelp: {
              topRight: '🏆 Total domination (>6.0 Y/play + 4+ explosive): Efficient И explosive - averaging 6+ yards И hitting home runs. First downs automatic, big plays bonus. 30+ PPG легко. Defense cannot key на anything',
              topLeft: '🎯 Feast or famine (<5.2 Y/play + 4+ explosive): Living на big plays только - между explosives идут 3-and-outs. Unsustainable variance. One game 400 yards, next game 200. Требует perfect execution на explosives',
              bottomLeft: '😔 Offensive poverty (<5.2 Y/play + <2 explosive): Cannot move ball consistently ИЛИ explosively. Punting championship. Under 250 total yards норма. Defense на field 35+ minutes getting worn down',
              bottomRight: '💪 Steady march (>6.0 Y/play + <2 explosive): Methodical efficiency - no big plays но consistent gains. Death by thousand cuts. Long drives eating clock. Effective но vulnerable to turnovers killing drives'
            }
          },
          {
            xKey: 'total_turnovers',
            yKey: 'total_takeaways',
            xLabel: 'Turnovers (Giveaways)',
            yLabel: 'Takeaways',
            title: 'Turnover Differential Components',
            insight: 'Top-right = aggressive both ways. Bottom-left = conservative. Diagonal = turnover margin.',
            metricHelp: '<strong>Giveaways vs Takeaways:</strong> Верхний правый = агрессивность с обеих сторон. Нижний левый = консервативность. Диагональ = turnover margin.',
            quadrantHelp: {
              topRight: '🎲 Riverboat gambling (25+ giveaways + 25+ takeaways): Living dangerously - forcing turnovers И giving them. Every game - rollercoaster с 5+ combined turnovers. Works если takeaway TDs > giveaway points. Coin flip football',
              topLeft: '🏆 Turnover masters (<15 giveaways + 25+ takeaways): +10 или better turnover differential. Ball security на offense + ball-hawking defense. Short fields one way. Championship formula когда sustained',
              bottomLeft: '🛡️ Risk averse (<15 giveaways + <15 takeaways): Conservative both ways - protecting ball, not attacking it. Low scoring affairs. Field position и special teams decide games. Boring но safe',
              bottomRight: '💀 Turnover donation center (25+ giveaways + <15 takeaways): -10 или worse differential. Giving possessions без getting back. Cannot overcome -2 per game margin. Season over by Week 10'
            }
          },
          {
            xKey: 'rec_yac_pct',
            yKey: 'rec_yds_per_catch',
            xLabel: 'Receiving YAC %',
            yLabel: 'Yards per Catch',
            title: 'Receiving YAC Creation',
            insight: 'YAC from short passes (high YAC%, low Y/C) vs downfield catches (low YAC%, high Y/C). Scheme design.',
            metricHelp: '<strong>YAC% vs Y/C:</strong> YAC от коротких передач (высокий YAC%, низкий Y/C) vs ловля на глубине (низкий YAC%, высокий Y/C). Схема дизайна.',
            quadrantHelp: {
              topRight: '🏆 YAC monsters everywhere (>50% YAC + >14 Y/C): Catching downfield И breaking tackles. Slants turning into 60-yarders. Deep crosses с RAC ability. Elite receiver talent making plays after catch. Defensive nightmare',
              topLeft: '🚀 Air yards specialists (<35% YAC + >14 Y/C): Pure vertical passing - catching balls 15+ yards downfield falling down. Jump balls, back shoulders, deep posts. No YAC needed когда catching в end zone',
              bottomLeft: '😔 Dead yards (<35% YAC + <11 Y/C): Short passes с immediate tackles. No separation, no space, no YAC. Contested catches на curls/hitches. Defense sitting on routes, rallying to ball',
              bottomRight: '🏃 YAC scheme masters (>50% YAC + <11 Y/C): Designed YAC - screens, drags, tunnels. Catching at 3 yards, running for 8. Scheme creating space, athletes maximizing. Modern West Coast evolution'
            }
          }
        ];

        const root = d3.select('#root');
        const sel = d3.select('#conf');

        function redraw() {
          const conf = sel.node().value;
          root.selectAll('*').remove();
          const rows = allRows.filter(r => 
            conf === 'ALL' || (r.conference || '').toUpperCase() === conf
          );
          charts.forEach(cfg => drawScatter(root, rows, cfg));
        }

        sel.on('change', redraw);
        redraw();
      }).catch(err => {
        d3.select('#root').append('div').style('color','crimson').text('Failed to load data: '+err);
        console.error(err);
      });
    }

    window.addEventListener('DOMContentLoaded', render);
  </script>
</head>
<body>
  <div class="container">
    <h1>Team Statistics — Interesting Correlations</h1>
    <div class="subtitle">
      34 non-obvious relationships between team metrics. Red = above trend, Blue = below trend.
      R² shows correlation strength. Each graph reveals strategic insights.
    </div>
    <div class="controls">
      <label for="conf">Conference:</label>
      <select id="conf">
        <option value="ALL" selected>All Conferences</option>
        <option value="AFC">AFC only</option>
        <option value="NFC">NFC only</option>
      </select>
    </div>
    <details class="info" open>
      <summary>What These Graphs Show</summary>
      <p>
        Unlike typical "stat vs Win%" charts, these explore <strong>cross-metric relationships</strong> that reveal:
      </p>
      <ul>
        <li><strong>Causation patterns</strong>: Does bad run defense force more interceptions?</li>
        <li><strong>Strategy trade-offs</strong>: Completion% vs passing depth, aggression vs ball security</li>
        <li><strong>Hidden connections</strong>: How pass rush affects coverage, how run game unlocks passing</li>
        <li><strong>Team identity</strong>: High-variance aggressive teams vs conservative ball-control teams</li>
      </ul>
      <p>
        <strong>R² (correlation strength)</strong>: 0.0 = no relationship, 1.0 = perfect correlation.
        Strong (≥0.5) = predictive relationship. Weak (&lt;0.25) = interesting outliers to explore.
      </p>
    </details>
    <div id="root"></div>
    <div class="subtitle">Data: stats_scripts/output/team_aggregated_stats.csv</div>
  </div>
</body>
</html>
